<h1>Schedule Updated!</h1>

<p>The schedule for <strong><%= @monitored_url.name %></strong> has been updated.</p>

<p><strong>URL:</strong> <%= link_to @monitored_url.url, @monitored_url.url %></p>

<% if @new_snapshot.schedule_data.present? && @new_snapshot.schedule_data.any? %>
  <h2>Updated Schedule:</h2>
  <table style="width: 100%; border-collapse: collapse; margin: 20px 0; background-color: #fff;">
    <thead>
      <tr style="background-color: #F97316; color: white;">
        <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">Date</th>
        <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">Time</th>
        <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">Matchup</th>
        <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">Location</th>
      </tr>
    </thead>
    <tbody>
      <% @new_snapshot.schedule_data.each_with_index do |game, index| %>
        <tr style="background-color: <%= index.even? ? '#f8f9fa' : '#fff' %>;">
          <td style="padding: 10px; border: 1px solid #ddd;"><%= game['date'] %></td>
          <td style="padding: 10px; border: 1px solid #ddd;"><%= game['time'] %></td>
          <td style="padding: 10px; border: 1px solid #ddd;">
            <strong><%= game['team1'] || game['home'] %></strong> vs <strong><%= game['team2'] || game['away'] || game['opponent'] %></strong>
          </td>
          <td style="padding: 10px; border: 1px solid #ddd;"><%= game['location'] %></td>
        </tr>
      <% end %>
    </tbody>
  </table>
<% else %>
  <h2>What Changed (AI Analysis):</h2>
  <div style="background-color: #fff3cd; padding: 15px; border-radius: 5px; margin: 20px 0; border-left: 4px solid #ffc107;">
    <%= simple_format @new_snapshot.ai_summary %>
  </div>
<% end %>

<p>
  <strong>Checked at:</strong> <%= @new_snapshot.checked_at.strftime("%B %d, %Y at %I:%M %p") %>
</p>

<hr style="margin: 30px 0;">

<p style="color: #666; font-size: 12px;">
  You're receiving this email because you're monitoring this URL in Schedule Alert.
  <br>
  To manage your monitored URLs, visit your dashboard.
</p>
